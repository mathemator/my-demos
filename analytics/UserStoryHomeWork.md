# User Stories и Use Cases для сервиса курьерской доставки

## 1. User Stories с критериями приёмки

### US-1: Расчёт стоимости доставки
**_Как_** клиент, **_я хочу_** рассчитать стоимость доставки, 
**_чтобы_** принять решение — заказывать ли курьера.

**Критерии приёмки:**
* Если я ввёл адрес отправителя и получателя, а также параметры посылки, то 
система рассчитывает стоимость и показывает её.
* Если я изменяю адрес или параметры груза до оплаты, то система пересчитывает стоимость.
* После подтверждения и перехода к оплате стоимость фиксируется и больше не меняется.

### US-2: Оплата доставки
**_Как_** клиент, **_я хочу_** выбрать, кто оплачивает доставку (я или получатель), 
**_чтобы_** распределить расходы удобным образом.

**Критерии приёмки:**
* При оформлении заказа доступен выбор "Оплачивает отправитель" или "Оплачивает получатель".
* Система показывает итоговую сумму и выбранную сторону оплаты на экране подтверждения.
* После оплаты выбранная сторона получает подтверждение, другая сторона видит статус "Оплачено".

### US-3: Отслеживание заказа
**_Как_** отправитель или получатель, **_я хочу_** видеть статус и местоположение курьера, 
**_чтобы_** быть уверенным, что доставка проходит успешно.

**Критерии приёмки:**
* После оплаты заказа я вижу:
  1) "Ожидает подтверждения курьером" (пока никто не взял заказ),
  2) И, когда курьер принимает заказ, я вижу его имя/идентификатор.
  3) Текущее состояние: "Курьер назначен", "Передано курьеру", "Доставлено".
* При передаче груза отправителем система фиксирует событие "Передано курьеру" с отметкой времени.
* При получении груза система фиксирует событие "Получено получателем" с отметкой времени.

---

## 2. Use Cases

### UC-1: Оформление заказа на доставку
**Акторы:** Клиент (отправитель), Система оплаты (внешняя).

**Основной поток:**
0. (Если клиент не авторизован - авторизация).
1. Клиент открывает приложение и выбирает "Создать заказ".
2. Вводит адрес отправителя и получателя, параметры груза.
3. Система рассчитывает стоимость.
4. Клиент подтверждает заказ, выбирает сторону оплаты.
5. Клиент (или выбранная сторона) оплачивает заказ.
6. Система фиксирует заказ, стоимость становится неизменной.

**Альтернативы:**
- 3a. Клиент изменяет адрес или параметры до оплаты — система выполняет перерасчёт стоимости.
- 4a. Клиент выбирает "Оплачивает получатель" — система направляет получателю ссылку на оплату.

**Исключения:**
- 5x. Оплата не проходит — заказ не создаётся, клиент получает уведомление об ошибке оплаты.

### UC-2: Отслеживание и завершение доставки
**Акторы:** Отправитель, Получатель, Курьер.

**Основной поток:**
1. После успешной оплаты заказ доступен для курьеров.
2. Курьер принимает заказ — система фиксирует выбранного курьера.
3. Отправитель передаёт груз курьеру, оба подтверждают в приложении.
4. Курьер начинает доставку; система отображает его текущее местоположение.
5. Курьер передаёт груз получателю; получатель подтверждает получение.
6. Система фиксирует завершение доставки.

**Альтернативы:**
- 2a. Ни один курьер не принимает заказ в течение заданного времени — заказ автоматически отменяется и деньги возвращаются плательщику.

**Исключения:**
- 4x. Курьер теряет связь (нет GPS или интернета) — система показывает последний доступный статус и уведомляет участников о задержке обновлений.

## 3. User Story Mapping (черновой бэклог)

**Основной пользовательский путь:**  
Создание заказа -> Оплата -> Отслеживание

---

### US-1: Расчёт стоимости доставки
**_Как_** клиент, **_я хочу_** рассчитать стоимость доставки,
**_чтобы_** принять решение — заказывать ли курьера.

**TASK-1:** Ввод адресов отправителя и получателя  
**TASK-2:** Ввод параметров груза (вес, размеры)  
**TASK-3:** Расчёт стоимости заказа  
**TASK-4:** Перерасчёт стоимости при изменении параметров до оплаты

---

### US-2: Оплата доставки
**_Как_** клиент, **_я хочу_** выбрать, кто оплачивает доставку (я или получатель),
**_чтобы_** распределить расходы удобным образом.

**TASK-5:** Выбор плательщика (отправитель / получатель)  
**TASK-6:** Оплата через интегрированный платёжный шлюз  
**TASK-7:** Подтверждение успешной оплаты и фиксирование выбранной стороны

---

### US-3: Отслеживание заказа
**_Как_** отправитель или получатель, **_я хочу_** видеть статус и местоположение курьера,
**_чтобы_** быть уверенным, что доставка проходит успешно.

**TASK-8:** Отображение статуса "Ожидает курьера"  
**TASK-9:** Обновление статуса на "Курьер назначен" после того, как курьер взял заказ  
**TASK-10:** Показ имени/ID курьера  
**TASK-11:** Фиксация передачи груза отправителем и получения груза получателем