–ü—Ä–æ—Ü–µ—Å—Å - —ç—Ç–æ —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –Ω–∞–±–æ—Ä–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö –∫–æ–º–∞–Ω–¥, 
–∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å –Ω–∏–º —Ä–µ—Å—É—Ä—Å–æ–≤ –∏
–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è,
–Ω–∞—Ö–æ–¥—è—â–∏–µ—Å—è –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –°–∏—Å—Ç–µ–º—ã.

–ü—Ä–æ—Ü–µ—Å—Å—ã –æ–±—Ä–∞–∑—É—é—Ç –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—É—é –∏–µ—Ä–∞—Ä—Ö–∏—é.
–°—É—â–µ—Å—Ç–≤—É–µ—Ç 2 –∫–æ—Ä–Ω—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:
* init/systemd (pid 1)
* kthreadd - –¥–∏—Å–ø–µ—Ç—á–µ—Ä –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–æ—Ç–æ–∫–æ–≤ —è–¥—Ä–∞ (pid 2)
* –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—é swapper/PID 0

–î–æ—á–µ—Ä–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞—Å–ª–µ–¥—É–µ—Ç —Ä–µ—Å—É—Ä—Å—ã —Ä–æ–¥–∏—Ç–µ–ª—è, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ.
–ò–Ω—Ñ–æ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –¥–æ—á–µ—Ä–Ω–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º—É.

üëª swapper / PID 0
* swapper (—á–∞—Å—Ç–æ —Ç–∞–∫–∂–µ sched –∏–ª–∏ idle) ‚Äî —ç—Ç–æ –ø–µ—Ä–≤—ã–π –ø–æ—Ç–æ–∫ —è–¥—Ä–∞, –∑–∞–ø—É—Å–∫–∞—é—â–∏–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –µ—â—ë –¥–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ user-space.
* –û–Ω –Ω–µ –æ–±—ã—á–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∏ –Ω–µ –∏–º–µ–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤ user space.
* –ü–æ—ç—Ç–æ–º—É ps, top, htop –µ–≥–æ –æ–±—ã—á–Ω–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç.
* –£ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–∏—Å—Ç–µ–º –µ—Å—Ç—å —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏–µ —Å–ª–µ–¥—ã –≤ /proc/0, –Ω–æ —á–∞—â–µ –≤—Å–µ–≥–æ ‚Äî —Ç–æ–ª—å–∫–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ dmesg –∏–ª–∏ cat /proc/sched_debug.

### üèÅ init vs systemd

init ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π "–ø–µ—Ä–≤—ã–π" –ø—Ä–æ—Ü–µ—Å—Å (PID 1) –≤ user-space:
–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ ‚Äî SysV init (—Å—Ç–∞—Ä—ã–µ Unix, —Ä–∞–Ω–Ω–∏–µ Linux).
–ó–∞–¥–∞—á–∏: –∑–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±–∞–º–∏, "—É—Å—ã–Ω–æ–≤–ª–µ–Ω–∏–µ" –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —á—å–∏ —Ä–æ–¥–∏—Ç–µ–ª–∏ —É–º–µ—Ä–ª–∏.
systemd ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–π –∂–µ —Ä–æ–ª–∏:
–¢–æ–∂–µ PID 1.
–ì–æ—Ä–∞–∑–¥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–µ–µ: –º–µ–Ω–µ–¥–∂–µ—Ä —Å–µ—Ä–≤–∏—Å–æ–≤ (unit-—Ñ–∞–π–ª—ã), –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π —Å—Ç–∞—Ä—Ç, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (journald), —Ç–∞–π–º–µ—Ä—ã, —Å–æ–∫–µ—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏—è –∏ —Ç.–¥.
–ù–∞ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–æ–≤ systemd = —Ç–æ—Ç —Å–∞–º—ã–π init, –ø—Ä–æ—Å—Ç–æ "–Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è".
–¢–æ –µ—Å—Ç—å "init" ‚Äî —ç—Ç–æ —Ä–æ–ª—å; "systemd" ‚Äî —Å–∞–º–∞—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω–∞—è –µ—ë —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è.

### –°–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ fork():
* –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
* –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ pid
* pid –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ä–æ–¥–∏—Ç–µ–ª—é
* —Ä–µ–±–µ–Ω–∫—É –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è ppid

–ø—Ä–∏ –§–æ—Ä–∫–µ –¥–æ—á–µ—Ä–Ω–µ–º—É –ø—Ä–æ—Ü–µ–æ—Å—Å—É –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–∫–∏, —Å –ø–æ–º–µ—Ç–∫–æ–π —Ç–æ–ª—å–∫–æ-–¥–ª—è-—á—Ç–µ–Ω–∏—è.  
–§–∞–∫—Ç–∏—á–µ—Å–∫–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç on demand.

### execve()
–°–µ–º–µ–π—Å—Ç–≤–æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ exec*:
- execl
- execlp
- execle
- execv
- execvp
- execvpe
```
l - list, v - vector
p - path,
e - enviornment
```
path - –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø–æ—Ä–æ–∂–¥–∞–µ–º–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å—Å—è –≤ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–º –ø—É—Ç–∏ (—Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ)  
e - –±—É–¥—É—Ç –ø–µ—Ä–µ–¥–∞–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**fork** —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ—Ü–µ—Å—Å, –∞ **exec** - –∑–∞–º–µ–Ω—è–µ—Ç –∫–æ–¥ –≤ –¥–æ—á–µ—Ä–Ω–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ. –û—á–µ–Ω—å —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–∞—Ä–æ–π.

### —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ clone() - "–ø—Ä–æ—Ü–µ—Å—Å" —Å —Ä–∞–∑–¥–µ–ª—è–µ–º—ã–º –∞–¥—Ä–µ—Å–Ω—ã–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º
clone() ‚Äî –±–∞–∑–æ–≤—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —Å—Ç—Ä–æ—è—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ –ø–æ—Ç–æ–∫–∏ (pthread), 
–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (—á–µ—Ä–µ–∑ CLONE_NEW* —Ñ–ª–∞–≥–∏ –¥–ª—è –Ω–µ–π–º—Å–ø–µ–π—Å–æ–≤).
–§–ª–∞–≥–∏:
- CLONE_VM - —Ä–∞–∑–¥–µ–ª—è–µ–º –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –µ—Å–ª–∏ –Ω–µ—Ç - —Ç–æ —ç—Ç–æ **–ø—Ä–æ—Ü–µ—Å—Å**
- CLONE_FS - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ - –∫–∞–∫–æ–π —Ç–µ–∫—É—â–∏–π, –∫–æ—Ä–Ω–µ–≤–æ–π, —Ä–µ–∂–∏–º —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–ª–æ–≤
- CLONE_FILES - —Ç–∞–±–ª–∏—Ü—ã –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤, —Ä–∞–∑–¥–µ–ª—è–µ–º –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏?
- CLONE_SIGHAND - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–∏–≥–Ω–∞–ª–æ–≤
- CLONE_PARENT - —É —Ä–µ–±—ë–Ω–∫–∞ –±—É–¥–µ—Ç —Ç–æ—Ç –∂–µ —Ä–æ–¥–∏—Ç–µ–ª—å, —á—Ç–æ –∏ —É –≤—ã–∑—ã–≤–∞—é—â–µ–≥–æ


–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å, –ø–æ–ª—É—á–∏–≤ —Å–∏–≥–Ω–∞–ª SIGCHLD –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –¥–æ—á–µ—Ä–Ω–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞,
–º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å wait –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–¥–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞. –û–° —Ç–æ–≥–¥–∞ –ø–æ–ª—É—á–∏—Ç –∫–æ–º–∞–Ω–¥—É –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
–¥–æ—á–µ—Ä–Ω–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –ï—Å–ª–∏ wait –Ω–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è - –û–° –ø—Ä–∏–∑–Ω–∞—ë—Ç –¥–æ—á–µ—Ä–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å –ó–æ–º–±–∏!
–ï–≥–æ –∫–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∏–∫—Ç–æ –Ω–µ –ø—Ä–æ—á–∏—Ç–∞–ª, –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–∞.
–û—Ç –∑–æ–º–±–∏-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–∑–±–∞–≤–∏—Ç—å—Å—è. –ê –ø–∏–¥–æ–≤ –≤—Å–µ–≥–æ 65–∫ (—Å–µ–π—á–∞—Å —É–∂–µ 4–º–ª–Ω).

–ï—Å–ª–∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Ä–∞–Ω—å—à–µ - –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —É—Å—ã–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª–µ–º.


### systemd

systemd

–ß—Ç–æ —ç—Ç–æ:
–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (init system) –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –º–µ–Ω–µ–¥–∂–µ—Ä —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–ª—É–∂–± –≤ Linux.

#### –ó–∞–¥–∞—á–∞:  
–≠—Ç–æ –ø–µ—Ä–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å (PID 1), –∫–æ—Ç–æ—Ä—ã–π —è–¥—Ä–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞.  

#### –û–Ω:
* –º–æ–Ω—Ç–∏—Ä—É–µ—Ç —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã,
* —Å—Ç–∞—Ä—Ç—É–µ—Ç —Å–ª—É–∂–±—ã (network, sshd, cron‚Ä¶),
* —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥–µ–º–æ–Ω–∞–º–∏, –ª–æ–≥–∞–º–∏, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ —Å–µ—Ä–≤–∏—Å–æ–≤,
* —Å–ª–µ–¥–∏—Ç –∑–∞ –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å –∏—Ö –ø—Ä–∏ —Å–±–æ—è—Ö.

#### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
systemd ‚Äî –Ω–µ —Ç–æ–ª—å–∫–æ ¬´—Å—Ç–∞—Ä—Ç–µ—Ä¬ª –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —ç—Ç–æ —Ü–µ–ª–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞: journald (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ), logind (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π), timedated (—á–∞—Å—ã –∏ –¥–∞—Ç–∞) –∏ —Ç.–¥.

### systemctl

#### –ß—Ç–æ —ç—Ç–æ:  
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∫–æ–º–∞–Ω–¥–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å systemd.

#### –ó–∞–¥–∞—á–∞:
–ß–µ—Ä–µ–∑ –Ω–µ—ë –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä (–∏–ª–∏ —Å–∫—Ä–∏–ø—Ç—ã) —É–ø—Ä–∞–≤–ª—è—é—Ç —é–Ω–∏—Ç–∞–º–∏ (units) systemd ‚Äî —ç—Ç–æ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–ª—É–∂–±—ã, —Ç–∞–π–º–µ—Ä—ã, —Ç–æ—á–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä.

–ü—Ä–∏–º–µ—Ä—ã:
systemctl status nginx         # –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã nginx
sudo systemctl start nginx     # –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É
sudo systemctl enable nginx    # –≤–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
sudo systemctl list-units --type=service  # —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
